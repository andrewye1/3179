{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "title": "South Australia Government Schools Enrollment by School",
  "autosize": {
  "type": "fit",
  "resize": true,
  "contains": "padding"
},
  "params": [
    {
      "name": "zoom_level",
      "value": 1000,
      "bind": {
        "input": "range",
        "min": 1000,
        "max": 50000,
        "step": 1000,
        "name": "Zoom: "
      }
    },
    {
      "name": "center_to",
      "value": [139.6, -23.9],
      "bind": {
        "input": "select",
        "options": [
          [138.6, -34.9],
          [135.5, -34.5],    
          [137.5, -32.9],
          [139.5, -35.5]
        ],
        "labels": ["Mount Gambier", "Adelaide", "Port Augusta", "Renmark"],
        "name": "Map Center: "
      }
    }
  ],
  "vconcat": [
    {
      "height": 400,
      "width": 600,
      "projection": {
        "type": "mercator",
        "center": {"expr": "center_to"},
        "scale": {"expr": "zoom_level"}
      },
      "layer": [
        {
          "data": {
            "url": "output.json",
            "format": {"type": "topojson", "feature": "sa_localities"}
          },
          "mark": {"type": "geoshape", "fill": "lightgray", "stroke": "white"}
        },
        {
          "data": {
            "url": "output.json",
            "format": {"type": "topojson", "feature": "ne_110m_graticules_1"}
          },
          "mark": {"type": "geoshape", "stroke": null}
        },
        {
          "data": {"url": "SAschools.csv"},
          "mark": {"type": "circle"},
          "encoding": {
            "longitude": {"field": "Longitude", "type": "quantitative"},
            "latitude": {"field": "Latitude", "type": "quantitative"},
            "size": {
              "field": "2023",
              "type": "quantitative",
              "scale": {"range": [10, 200]},
              "title": "Enrollment Size"
            },
            "color": {
              "field": "School_Type",
              "type": "nominal",
              "title": "School Type",
              "scale": {"scheme": "category10"}
            },
            "tooltip": [
              {"field": "School_Name", "type": "nominal", "title": "School Name"},
              {"field": "2023", "type": "quantitative", "title": "Enrollment (2023)"},
              {"field": "Suburb", "type": "nominal", "title": "Suburb"},
              {"field": "Post_Code", "type": "nominal", "title": "Postcode"}
            ]
          }
        }
      ]
    },
    {
      "height": 400,
      "width": 600,
      "title": "Total South Australia School Entrollment",
      "data": {"url": "SAschools.csv"},
      "transform": [
        {
          "fold": ["2009", "2010", "2011", "2012", "2013", "2014", "2015", "2016", "2017", "2018", "2019", "2020", "2021", "2022", "2023"],
          "as": ["Year", "Enrollment"]
        },
        {
          "aggregate": [
            {"op": "sum", "field": "Enrollment", "as": "Total Enrollment"}
          ],
          "groupby": ["Year"]
        }
      ],
      "mark": "line",
      "encoding": {
        "x": {"field": "Year", "type": "ordinal"},
        "y": {"field": "Total Enrollment", "type": "quantitative"},
        "tooltip": [
          {"field": "Year", "type": "ordinal"},
          {
            "field": "Total Enrollment",
            "type": "quantitative",
            "title": "Total Enrollment"
          }
        ]
      }
    }
  ]
}